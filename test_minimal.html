<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Minimal MapLibre Test</title>
    <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css" />
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    </style>
</head>
<body>
<div id="map"></div>
<script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>
<script>
    console.log('MapLibre version:', maplibregl.version);
    console.log('MapLibre supported:', maplibregl.supported());

    // Absolutely minimal style - just a blue background, no tiles needed
    const map = new maplibregl.Map({
        container: 'map',
        style: {
            version: 8,
            sources: {},
            layers: [{
                id: 'background',
                type: 'background',
                paint: {
                    'background-color': '#0080ff'  // Bright blue - impossible to miss
                }
            }]
        },
        center: [0, 0],
        zoom: 2
    });

    map.on('load', () => {
        console.log('✅ MAP LOADED');
        console.log('Style:', map.getStyle());

        setTimeout(() => {
            const canvas = map.getCanvas();
            console.log('Canvas:', canvas.width, 'x', canvas.height);

            // Check WebGL
            const gl = canvas.getContext('webgl2') || canvas.getContext('webgl');
            if (gl) {
                console.log('✅ WebGL:', gl.getParameter(gl.VERSION));
                console.log('Vendor:', gl.getParameter(gl.VENDOR));
                console.log('Renderer:', gl.getParameter(gl.RENDERER));
            } else {
                console.error('❌ NO WEBGL!');
            }

            // Try to get pixel data
            try {
                const pixel = new Uint8Array(4);
                gl.readPixels(canvas.width/2, canvas.height/2, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, pixel);
                console.log('Center pixel color:', Array.from(pixel));
                if (pixel[0] === 0 && pixel[1] === 128 && pixel[2] === 255) {
                    console.log('✅ BLUE BACKGROUND RENDERING!');
                } else {
                    console.error('❌ Wrong color or not rendering');
                }
            } catch(e) {
                console.error('Cannot read pixels:', e);
            }
        }, 2000);
    });

    map.on('error', (e) => {
        console.error('❌ MAP ERROR:', e);
    });
</script>
</body>
</html>
